<!DOCTYPE html><html lang="zh-CN"><head><meta http-equiv="content-type" content="text/html; charset=utf-8"><meta content="width=device-width,initial-scale=1,maximum-scale=1,user-scalable=0" name="viewport"><meta content="yes" name="apple-mobile-web-app-capable"><meta content="black-translucent" name="apple-mobile-web-app-status-bar-style"><meta content="telephone=no" name="format-detection"><meta name="description" content="伪全栈"><meta name="baidu-site-verification" content="yKAzGITNoG"><title>JavaScript 编程实践 | Smackgg</title><link rel="stylesheet" type="text/css" href="/css/style.css?v=0.0.0"><link rel="stylesheet" type="text/css" href="//cdn.bootcss.com/normalize/8.0.0/normalize.min.css"><link rel="stylesheet" type="text/css" href="//cdn.bootcss.com/pure/1.0.0/pure-min.css"><link rel="stylesheet" type="text/css" href="//cdn.bootcss.com/pure/1.0.0/grids-responsive-min.css"><link rel="stylesheet" href="//cdn.bootcss.com/font-awesome/4.7.0/css/font-awesome.min.css"><script type="text/javascript" src="//cdn.bootcss.com/jquery/3.3.1/jquery.min.js"></script><link rel="Shortcut Icon" type="image/x-icon" href="/favicon.ico"><link rel="apple-touch-icon" href="/apple-touch-icon.png"><link rel="apple-touch-icon-precomposed" href="/apple-touch-icon.png"></head><body><div class="body_container"><div id="header"><div class="site-name"><h1 class="hidden">JavaScript 编程实践</h1><a id="logo" href="/.">Smackgg</a><p class="description">你好，兄dei</p></div><div id="nav-menu"> <a class="current" href="/."><i class="fa fa-home">首页</i></a> <a href="/archives/"><i class="fa fa-archive">归档</i></a> <a href="/about/"><i class="fa fa-user">关于</i></a> <a href="/atom.xml"><i class="fa fa-rss">订阅</i></a></div></div><div class="pure-g" id="layout"><div class="pure-u-1 pure-u-md-3-4"><div class="content_container"><div class="post"><h1 class="post-title">JavaScript 编程实践</h1><div class="post-meta">Aug 4, 2015 <span>|</span> <span class="category"><a href="/categories/高性能JavaScript-8/">高性能JavaScript-8</a></span> <span>|</span><span class="leancloud_visitors" id="/2015/08/04/高性能JavaScript8/" data-flag-title="JavaScript 编程实践"><span id="leancloud-visitors-count"></span> <span>阅读</span></span></div><a class="ds-thread-count" href="/2015/08/04/高性能JavaScript8/#SOHUCS"><span id="changyan_count_unit" style="font-size:15px;color:#6E7173">0</span> <span>条评论</span></a><script src="https://assets.changyan.sohu.com/upload/plugins/plugins.count.js" async></script><div class="post-content"><h1 id="第八章-Programming-Practices-编程实践"><a href="#第八章-Programming-Practices-编程实践" class="headerlink" title="第八章 Programming Practices 编程实践"></a><strong>第八章 Programming Practices 编程实践</strong></h1><a id="more"></a><hr><p>每种编程语言都有痛点，而且低效模式随着时间的推移不断发展。其原因在于，越来越多的人们开始使用这种语言，不断扩种它的边界。自 2005 年以来，当术语“Ajax”出现时，网页开发者对 JavaScript 和浏览器的推动作用远超过以往。其结果是出现了一些非常具体的模式，即有优秀的做法也有糟糕的做法。这些模式的出现，是因为网络上 JavaScript 的性质决定的。</p><blockquote><ul><li>JavaScript与许多脚本语言一样，允许你在程序中获取一个包含代码的字符串然后运行它。有四种标准方法可以实现： eval_r()， Function()构造器， setTimeout()和 setInterval()。每个函数允许你传入一串 JavaScript代码，然后运行它。例如：</li></ul></blockquote><pre><code>var num1 = 5,
num2 = 6,
//eval_r() evaluating a string of code
result = eval_r(&quot;num1 + num2&quot;),
//Function() evaluating strings of code
sum = new Function(&quot;arg1&quot;, &quot;arg2&quot;, &quot;return arg1 + arg2&quot;);
//setTimeout() evaluating a string of code
setTimeout(&quot;sum = num1 + num2&quot;, 100);
//setInterval() evaluating a string of code
setInterval(&quot;sum = num1 + num2&quot;, 100);
</code></pre><p>大多数情况下，没必要使用 eval_r()或 Function()，如果可能的话，尽量避免使用它们。至于另外两个函数，setTimeout()和 setInterval()，第一个参数传入一个函数而不是一个字符串。例如：</p><pre><code>setTimeout(function(){
    sum = num1 + num2;
}, 100);
setInterval(function(){
    sum = num1 + num2;
}, 100);
</code></pre><hr><blockquote><ul><li>尽量使用对象直接量。这样可以提高性能，同时减少代码量。</li></ul></blockquote><blockquote><ul><li>不要做重复的工作。下面例子解决重复工作的问题。</li></ul></blockquote><pre><code>function addHandler(target, eventType, handler){
    if (target.addEventListener){ //DOM2 Events
        target.addEventListener(eventType, handler, false);
    } else { //IE
        target.attachEvent(&quot;on&quot; + eventType, handler);
    }
}
function removeHandler(target, eventType, handler){
    if (target.removeEventListener){ //DOM2 Events
        target.removeEventListener(eventType, handler, false);
    } else { //IE
        target.detachEvent(&quot;on&quot; + eventType, handler);
    }
}
</code></pre><p>隐藏的性能问题在于每次函数调用时都执行重复工作。每一次，都进行同样的检查，看看某种方法是否存在。如果你假设 target 唯一的值就是 DOM 对象，而且用户不可能在页面加载时魔术般地改变浏览器，那么这种判断就是重复的。如果 addHandler()一上来就调用addEventListener()那么每个后续调用都要出现这句代码。在每次调用中重复同样的工作是一种浪费，有多种办法避免这一点。</p><p>可以使用延迟加载：</p><pre><code>function addHandler(target, eventType, handler){
        //overwrite the existing function
    if (target.addEventListener){ //DOM2 Events
        addHandler = function(target, eventType, handler){
            target.addEventListener(eventType, handler, false);
        };
    } else { //IE
        addHandler = function(target, eventType, handler){
            target.attachEvent(&quot;on&quot; + eventType, handler);
        };
    }
    //call the new function
    addHandler(target, eventType, handler);
    }
    function removeHandler(target, eventType, handler){
        //overwrite the existing function
        if (target.removeEventListener){ //DOM2 Events
            removeHandler = function(target, eventType, handler){
                target.addEventListener(eventType, handler, false);
            };
        } else { //IE
            removeHandler = function(target, eventType, handler){
            target.detachEvent(&quot;on&quot; + eventType, handler);
        };
    }
    //call the new function
    removeHandler(target, eventType, handler);
}
</code></pre><p>条件预加载：</p><pre><code>var addHandler = document.body.addEventListener ?
function(target, eventType, handler){
    target.addEventListener(eventType, handler, false);
}:
function(target, eventType, handler){
    target.attachEvent(&quot;on&quot; + eventType, handler);
};
var removeHandler = document.body.removeEventListener ?
function(target, eventType, handler){
    target.removeEventListener(eventType, handler, false);
}:
function(target, eventType, handler){
    target.detachEvent(&quot;on&quot; + eventType, handler);
};
</code></pre><hr><blockquote><ul><li>使用位操作符可以提升性能。</li><li>尽量使用原生方法，可以提高性能。如Math.abs(num)等。</li></ul></blockquote><hr><h1 id="Summary-总结"><a href="#Summary-总结" class="headerlink" title="Summary 总结"></a>Summary 总结</h1><hr><p>JavaScript 提出了一些独特的性能挑战，关系到你组织代码的方法。网页应用变得越来越高级，包含的<br>JavaScript 代码越来越多，出现了一些模式和反模式。请牢记以下编程经验：</p><blockquote><ul><li>通过避免使用 eval_r()和 Function()构造器避免二次评估。此外，给 setTimeout()和 setInterval()传递函数参数而不是字符串参数。</li><li>创建新对象和数组时使用对象直接量和数组直接量。它们比非直接量形式创建和初始化更快。</li><li>避免重复进行相同工作。当需要检测浏览器时，使用延迟加载或条件预加载。</li><li>当执行数学远算时，考虑使用位操作，它直接在数字底层进行操作。</li><li>原生方法总是比 JavaScript 写的东西要快。尽量使用原生方法。</li><li>本书涵盖了很多技术和方法，如果将这些优化应用在那些经常运行的代码上，你将会看到巨大的性能提升。</li></ul></blockquote></div><iframe src="/donate/?AliPayQR=/img/AliPayQR.jpg&amp;WeChatQR=/img/WeChatQR.jpg&amp;GitHub=https://github.com/smackgg&amp;BTCQR=null&amp;BTCKEY=null&amp;PayPal=null" style="overflow-x:hidden;overflow-y:hidden;border:0xp none #fff;min-height:240px;width:100%" frameborder="0" scrolling="no"></iframe><div class="tags"><a href="/tags/高性能JavaScript学习笔记/">高性能JavaScript学习笔记</a></div><div class="post-nav"><a class="pre" href="/2015/08/05/高性能JavaScript9/">创建并部署高性能 JavaScript</a><a class="next" href="/2015/08/04/高性能JavaScript7/">JavaScript Ajax优化</a></div><div id="SOHUCS" sid="1438687278000"></div><script>!function(){var t="cytwmWeN3",e="54ae93d9b5daa95aace5bfdf4e84dca1",n=window.innerWidth||document.documentElement.clientWidth;if(n<960)window.document.write('<script id="changyan_mobile_js" charset="utf-8" type="text/javascript" src="https://changyan.sohu.com/upload/mobile/wap-js/changyan_mobile.js?client_id='+t+"&conf="+e+'"><\/script>');else{var a=function(t,e){var n=document.getElementsByTagName("head")[0]||document.head||document.documentElement,a=document.createElement("script");a.setAttribute("type","text/javascript"),a.setAttribute("charset","UTF-8"),a.setAttribute("src",t),"function"==typeof e&&(window.attachEvent?a.onreadystatechange=function(){var t=a.readyState;"loaded"!==t&&"complete"!==t||(a.onreadystatechange=null,e())}:a.onload=e),n.appendChild(a)};a("https://changyan.sohu.com/upload/changyan.js",function(){window.changyan.api.config({appid:t,conf:e})})}}()</script></div></div></div><div class="pure-u-1-4 hidden_mid_and_down"><div id="sidebar"><div class="widget"><form class="search-form" action="//www.google.com/search" method="get" accept-charset="utf-8" target="_blank"><input type="text" name="q" maxlength="20" placeholder="Search"><input type="hidden" name="sitesearch" value="http://blog.smackgg.cn"></form></div><div class="widget"><div class="widget-title"> <i class="fa fa-folder-o">分类</i></div><ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/categories/Electron/">Electron</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/hexo/">hexo</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/与-CSS-相关的兼容性问题/">与 CSS 相关的兼容性问题</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/与渲染HTML相关的兼容性问题/">与渲染HTML相关的兼容性问题</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/与渲染混合类型相关的兼容性问题/">与渲染混合类型相关的兼容性问题</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/与脚本相关的兼容性问题/">与脚本相关的兼容性问题</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/作用域链和标识符详细解析/">作用域链和标识符详细解析</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/关于主题/">关于主题</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/浅谈BFC实际应用/">浅谈BFC实际应用</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/高性能JavaScript-1/">高性能JavaScript-1</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/高性能JavaScript-10/">高性能JavaScript-10</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/高性能JavaScript-2/">高性能JavaScript-2</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/高性能JavaScript-3/">高性能JavaScript-3</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/高性能JavaScript-4/">高性能JavaScript-4</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/高性能JavaScript-5/">高性能JavaScript-5</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/高性能JavaScript-6/">高性能JavaScript-6</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/高性能JavaScript-7/">高性能JavaScript-7</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/高性能JavaScript-8/">高性能JavaScript-8</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/高性能JavaScript-9/">高性能JavaScript-9</a></li></ul></div><div class="widget"><div class="widget-title"> <i class="fa fa-star-o">标签</i></div><div class="tagcloud"><a href="/tags/Electron/" style="font-size:15px">Electron</a> <a href="/tags/hexo/" style="font-size:15px">hexo</a> <a href="/tags/兼容性/" style="font-size:15px">兼容性</a> <a href="/tags/高性能JavaScript学习笔记/" style="font-size:15px">高性能JavaScript学习笔记</a> <a href="/tags/CSS/" style="font-size:15px">CSS</a> <a href="/tags/没事瞎扯/" style="font-size:15px">没事瞎扯</a></div></div><div class="widget"><div class="widget-title"> <i class="fa fa-file-o">最近文章</i></div><ul class="post-list"><li class="post-list-item"><a class="post-list-link" href="/2017/03/08/electron-daying/">使用 Electron 快速开发桌面应用(附实例，源码)。</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/10/31/hexo主题添加阅读数/">为hexo-theme-smackdown主题添加阅读数</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/10/12/写代码强行装逼/">写代码强行装逼</a></li><li class="post-list-item"><a class="post-list-link" href="/2015/08/21/与 CSS 相关的兼容性问题/">与 CSS 相关的兼容性问题</a></li><li class="post-list-item"><a class="post-list-link" href="/2015/08/19/与脚本相关的兼容性问题/">与脚本相关的兼容性问题</a></li><li class="post-list-item"><a class="post-list-link" href="/2015/08/15/与服务端通信相关的兼容性问题/">与脚本相关的兼容性问题</a></li><li class="post-list-item"><a class="post-list-link" href="/2015/08/14/与渲染混合类型相关的兼容性问题/">与渲染混合类型相关的兼容性问题</a></li><li class="post-list-item"><a class="post-list-link" href="/2015/08/12/与渲染HTML相关的兼容性问题/">与渲染HTML相关的兼容性问题</a></li><li class="post-list-item"><a class="post-list-link" href="/2015/08/08/浅谈BFC实际应用/">浅谈BFC的实际应用</a></li><li class="post-list-item"><a class="post-list-link" href="/2015/08/06/高性能JavaScrip10/">JavaScript优化之工具</a></li></ul></div><div class="widget"><div class="widget-title"> <i class="fa fa-external-link">友情链接</i></div><ul></ul><a href="https://github.com/smackgg/hexo-theme-smackdown" title="hexo-theme-smackdown" target="_blank">hexo-theme-smackdown</a></div></div></div><div class="pure-u-1 pure-u-md-3-4"><div id="footer">Copyright © 2018 <a href="/." rel="nofollow">Smackgg.</a> Powered by <a rel="nofollow" target="_blank" href="https://hexo.io">Hexo.</a> <a rel="nofollow" target="_blank" href="https://github.com/tufu9441/maupassant-hexo">Theme</a> by <a rel="nofollow" target="_blank" href="https://github.com/pagecho">Cho.</a></div></div></div><a class="show" id="rocket" href="#top"></a><script type="text/javascript" src="/js/totop.js?v=0.0.0" async></script><script type="text/javascript" src="//cdn.bootcss.com/fancybox/3.2.5/jquery.fancybox.min.js" async></script><script type="text/javascript" src="/js/fancybox.js?v=0.0.0" async></script><link rel="stylesheet" type="text/css" href="//cdn.bootcss.com/fancybox/3.2.5/jquery.fancybox.min.css"><script type="text/javascript" src="/js/codeblock-resizer.js?v=0.0.0"></script><script type="text/javascript" src="/js/smartresize.js?v=0.0.0"></script><script src="https://cdn1.lncld.net/static/js/av-core-mini-0.6.1.js"></script><script>AV.initialize("K1qAIJa0JgKeGUnrlq0G526F-gzGzoHsz","n4XwRe0iBOxWpBaYJ7HNWPA3")</script><script type="text/javascript" src="/js/Counter.js?v=0.0.0" async></script><span>Smackgg.</span></div></body></html>